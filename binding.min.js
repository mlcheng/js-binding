"use strict";function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var iqwerty=iqwerty||{};iqwerty.binding=function(){function t(t,e){return!!e.find(function(e){return t.tagName.toLowerCase()===e})}function e(t,e){return e.some(function(e){return t.hasAttribute(e)})}function n(r,o,i){i instanceof Array||(i=[i]),n.prototype.setId(r),n.prototype.updateBindings(r[u],o,i,r[o]),n.prototype.updateViews(r[u],o),i.forEach(function(n){(t(n,["input","textarea"])||e(n,["contenteditable"]))&&n.addEventListener("input",function(){r[o]=n.innerHTML||n.value})}),Object.defineProperty(r,o,{get:function(){return n.prototype.Bindings[r[u]][o].value},set:function(t){n.prototype.Bindings[r[u]][o].value=t,n.prototype.updateViews(r[u],o)},configurable:!0})}function r(t,e){return!!Object.keys(t).find(function(t){return e===t})}function o(t){setTimeout(function(){var e=document.querySelectorAll("["+d+"]");0!==e.length&&[].slice.call(e).forEach(function(e){var o=e.dataset.iqBind;if(o=new RegExp(c).exec(o)){var i=o[1];if(r(t,i)){var a=t[i];n(a,o[2],e)}}})},0)}function i(t){setTimeout(function(){var e=document.querySelectorAll("["+f+"]");0!==e.length&&[].slice.call(e).forEach(function(e){var o=e.dataset.iqBindScope,i="{ *?"+(o?p:c)+" *?}";i=new RegExp(i,"g");var a,u=[];do if(a=i.exec(e.innerHTML)){var d=o||a[1];if(!r(t,d))return;u.push({matched:a[0],obj:d,prop:(o?a[1]:a[2]).trim(),id:s+"-"+n.prototype.getId()})}while(a);if(0!==u.length){var f=e.innerHTML;u.forEach(function(t){var e=document.createElement("span");e.classList.add(s),e.id=t.id,f=f.replace(t.matched,e.outerHTML)}),e.innerHTML=f,u.forEach(function(e){var r=t[e.obj],o=document.getElementById(e.id);n(r,e.prop,o),o.removeAttribute("id")})}})},0)}function a(t){Object.keys(t).forEach(function(e){n.prototype.setId(t[e]),n.prototype.addBinding(t[e])}),o(t),i(t)}var u="$$id",p="([^.}]+)",c=p+"."+p,d="data-iq-bind",f="data-iq-bind-scope",s="iq-bind";return n.prototype.Bindings={},n.prototype.addBinding=function(t){var e=n.prototype.Bindings;e[t[u]]||(e[t[u]]={})},n.prototype.updateBindings=function(t,e,r,o){var i,a=n.prototype.Bindings;a[t]||(a[t]={}),a[t][e]||(a[t][e]={elems:[],value:o}),(i=a[t][e].elems).push.apply(i,_toConsumableArray(r))},n.prototype.updateViews=function(e,r){var o,i=n.prototype.Bindings[e][r].elems;i.forEach(function(i){o=t(i,["input","textarea"])?"value":"innerHTML";var a=n.prototype.Bindings[e][r].value;i[o]!==a&&(i[o]=a)})},n.prototype._id=0,n.prototype.getId=function(){return n.prototype._id++},n.prototype.setId=function(t){null==t[u]&&Object.defineProperty(t,u,{value:n.prototype.getId()})},{Bind:n,Model:a}}();